{"version":3,"sources":["auth.js"],"names":["errorMessage","res","message","status","json","auth","req","next","header","headers","authorization","token","jwt","verify","user","err"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,OAAN,EAAkB;AACrCD,EAAAA,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBD,IAAAA,MAAM,EAAE,OADS;AAEjBD,IAAAA,OAAO,EAAPA;AAFiB,GAArB;AAID,CALD;;AAOA,IAAMG,IAAI,GAAG,SAAPA,IAAO,CAACC,GAAD,EAAML,GAAN,EAAWM,IAAX,EAAoB;AAC/B,MAAI;AACF,QAAMC,MAAM,GAAGF,GAAG,CAACG,OAAJ,CAAYC,aAA3B;;AACA,QAAI,CAACF,MAAL,EAAa;AACb,aAAOR,YAAY,CAACC,GAAD,EAAM,GAAN,EAAW,sCAAX,CAAnB;AACC;;AACD,QAAMU,KAAK,GAAGC,yBAAIC,MAAJ,CAAWL,MAAX,EAAmB,YAAnB,CAAd;;AACAF,IAAAA,GAAG,CAACQ,IAAJ,GAAWH,KAAX;AACAJ,IAAAA,IAAI;AACL,GARD,CAQE,OAAOQ,GAAP,EAAY;AACZ,WAAOf,YAAY,CAACC,GAAD,EAAM,GAAN,EAAW,6BAAX,CAAnB;AACD;;AACD,SAAO,KAAP;AACD,CAbD;;eAeeI,I","sourceRoot":"C:\\Auto-Mart-Website\\server\\middleware","sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst errorMessage = (res, message) => {\r\n  res.status(401).json({\r\n      status: 'error',\r\n      message\r\n  });\r\n};\r\n\r\nconst auth = (req, res, next) => {\r\n  try {\r\n    const header = req.headers.authorization;\r\n    if (!header) {\r\n    return errorMessage(res, 401, 'Authorization token was not provided');\r\n    }\r\n    const token = jwt.verify(header, 'SECRET_KEY');\r\n    req.user = token;\r\n    next();\r\n  } catch (err) {\r\n    return errorMessage(res, 401, 'Invalid authorization token');\r\n  }\r\n  return false;\r\n};\r\n\r\nexport default auth;\r\n"]}