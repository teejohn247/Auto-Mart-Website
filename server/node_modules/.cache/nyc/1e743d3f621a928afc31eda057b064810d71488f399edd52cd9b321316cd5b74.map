{"version":3,"sources":["auth.js"],"names":["auth","req","res","next","header","headers","authorization","status","json","error","token","jwt","verify","user"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,IAAI,GAAG,SAAPA,IAAO,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC/B,MAAI;AACF,QAAMC,MAAM,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAA3B;AACA,QAAI,CAACF,MAAD,IAAWA,MAAM,KAAK,EAA1B,EAA8B,OAAOF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,MAAAA,MAAM,EAAE,GAAV;AAAeE,MAAAA,KAAK,EAAE;AAAtB,KAArB,CAAP;;AAE9B,QAAMC,KAAK,GAAGC,yBAAIC,MAAJ,CAAWR,MAAX,EAAmB,YAAnB,CAAd;;AACAH,IAAAA,GAAG,CAACY,IAAJ,GAAWH,KAAX;AACAP,IAAAA,IAAI;AACL,GAPD,CAOE,gBAAM;AACN,WAAOD,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,MAAAA,MAAM,EAAE,GAAV;AAAeE,MAAAA,KAAK,EAAE;AAAtB,KAArB,CAAP;AACD;;AACD,SAAO,KAAP;AACD,CAZD;;eAceT,I","sourceRoot":"G:\\Auto-Mart-Website\\server\\middleware","sourcesContent":["import jwt from 'jsonwebtoken';\n\nconst auth = (req, res, next) => {\n  try {\n    const header = req.headers.authorization;\n    if (!header || header === '') return res.status(401).json({ status: 401, error: 'Unauthorized' });\n\n    const token = jwt.verify(header, 'SECRET_KEY');\n    req.user = token;\n    next();\n  } catch {\n    return res.status(401).json({ status: 401, error: 'Invalid token!' });\n  }\n  return false;\n};\n\nexport default auth;\n"]}