{"version":3,"sources":["purchaseOrder.js"],"names":["Order","req","res","validateOrder","validation","body","error","status","json","details","message","newOrder","id","parseInt","order","length","buyer","car_id","amount","userId","users","find","b","carId","cars","c","latestOrder","created_on","Date","price","price_offered","push","data"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,IAAMA,KAAK,GAAG,SAARA,KAAQ,CAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,8BACRC,2BAAcC,UAAd,CAAyBH,GAAG,CAACI,IAA7B,CADQ;AAAA,MAClBC,KADkB,yBAClBA,KADkB;;AAE1B,MAAIA,KAAJ,EAAW;AACT,WAAOJ,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAED,MAAAA,MAAM,EAAE,GAAV;AAAeD,MAAAA,KAAK,EAAEA,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiBC;AAAvC,KAArB,CAAP;AACD;;AAED,MAAMC,QAAQ,GAAG;AACfC,IAAAA,EAAE,EAAEC,QAAQ,CAACC,0BAAMC,MAAN,GAAe,CAAhB,EAAmB,EAAnB,CADG;AAEfC,IAAAA,KAAK,EAAEf,GAAG,CAACI,IAAJ,CAASW,KAFD;AAGfC,IAAAA,MAAM,EAAEhB,GAAG,CAACI,IAAJ,CAASY,MAHF;AAIfC,IAAAA,MAAM,EAAEjB,GAAG,CAACI,IAAJ,CAASa,MAJF;AAKfX,IAAAA,MAAM,EAAEN,GAAG,CAACI,IAAJ,CAASE,MAAT,IAAmB;AALZ,GAAjB;;AAOA,MAAMY,MAAM,GAAGC,kBAAMC,IAAN,CAAW,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAACV,EAAF,KAASC,QAAQ,CAACF,QAAQ,CAACK,KAAV,EAAiB,EAAjB,CAArB;AAAA,GAAZ,CAAf;;AACA,MAAI,CAACG,MAAL,EAAa;AACX,WAAOjB,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BD,MAAAA,KAAK,EAAE;AAFmB,KAArB,CAAP;AAID;;AAED,MAAMiB,KAAK,GAAGC,qBAAKH,IAAL,CAAU,UAAAI,CAAC;AAAA,WAAIA,CAAC,CAACb,EAAF,KAASC,QAAQ,CAACF,QAAQ,CAACM,MAAV,EAAkB,EAAlB,CAArB;AAAA,GAAX,CAAd;;AACA,MAAI,CAACM,KAAL,EAAY;AACV,WAAOrB,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,GADkB;AAE1BD,MAAAA,KAAK,EAAE;AAFmB,KAArB,CAAP;AAID;;AACA,MAAMoB,WAAW,GAAG;AACjBT,IAAAA,MAAM,EAAEN,QAAQ,CAACM,MADA;AAEjBU,IAAAA,UAAU,EAAEC,IAAI,EAFC;AAGjBrB,IAAAA,MAAM,EAAEI,QAAQ,CAACJ,MAHA;AAIjBsB,IAAAA,KAAK,EAAEN,KAAK,CAACM,KAJI;AAKjBC,IAAAA,aAAa,EAAEnB,QAAQ,CAACO;AALP,GAApB;;AAQDJ,4BAAMiB,IAAN,CAAWpB,QAAX;;AACA,SAAOT,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,IAAAA,MAAM,EAAE,GADkB;AAE1ByB,IAAAA,IAAI,EAAEN;AAFoB,GAArB,CAAP;AAID,CAzCD;;eA2Ce1B,K","sourceRoot":"C:\\Auto-Mart-Website\\server\\controllers","sourcesContent":["import order from '../models/purchaseOrder';\r\nimport users from '../models/users';\r\nimport cars from '../models/postCars';\r\nimport validateOrder from '../helpers/purchaseOrder';\r\n\r\nconst Order = (req, res) => {\r\n  const { error } = validateOrder.validation(req.body);\r\n  if (error) {\r\n    return res.status(400).json({ status: 400, error: error.details[0].message });\r\n  }\r\n\r\n  const newOrder = {\r\n    id: parseInt(order.length + 1, 10),\r\n    buyer: req.body.buyer,\r\n    car_id: req.body.car_id,\r\n    amount: req.body.amount,\r\n    status: req.body.status || 'pending',\r\n  };\r\n  const userId = users.find(b => b.id === parseInt(newOrder.buyer, 10));\r\n  if (!userId) {\r\n    return res.status(404).json({\r\n      status: 404,\r\n      error: 'buyer id not found',\r\n    });\r\n  }\r\n\r\n  const carId = cars.find(c => c.id === parseInt(newOrder.car_id, 10));\r\n  if (!carId) {\r\n    return res.status(404).json({\r\n      status: 404,\r\n      error: 'car ordered not found',\r\n    });\r\n  }\r\n   const latestOrder = {\r\n      car_id: newOrder.car_id,\r\n      created_on: Date(),\r\n      status: newOrder.status,\r\n      price: carId.price,\r\n      price_offered: newOrder.amount\r\n  };\r\n\r\n  order.push(newOrder);\r\n  return res.status(201).json({\r\n    status: 201,\r\n    data: latestOrder\r\n  });\r\n};\r\n\r\nexport default Order;\r\n"]}