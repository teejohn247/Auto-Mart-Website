{"version":3,"sources":["markAd.js"],"names":["markadsold","req","res","validateUpdateStatus","validation","body","error","status","json","details","message","carId","params","id","carIndex","ads","findIndex","o","parseInt","originalCar","newCarStatus","email","createdOn","format","manufacturer","model","price","state","owner","data"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,8BACbC,oBAAqBC,UAArB,CAAgCH,GAAG,CAACI,IAApC,CADa;AAAA,MACvBC,KADuB,yBACvBA,KADuB;;AAE/B,MAAIA,KAAJ,EAAW;AACTJ,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,MAAAA,MAAM,EAAE,GADW;AAEnBD,MAAAA,KAAK,EAAEA,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiBC;AAFL,KAArB;AAIA;AACD;;AACD,MAAMC,KAAK,GAAGV,GAAG,CAACW,MAAJ,CAAWC,EAAzB;;AACA,MAAMC,QAAQ,GAAGC,gBAAIC,SAAJ,CAAc,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAACJ,EAAF,KAASK,QAAQ,CAACP,KAAD,EAAQ,EAAR,CAArB;AAAA,GAAf,CAAjB;;AACA,MAAIG,QAAQ,GAAG,CAAC,CAAhB,EAAmB;AACjB,QAAMK,WAAW,GAAGJ,gBAAID,QAAJ,CAApB;;AACA,QAAIK,WAAW,CAACZ,MAAZ,KAAuB,WAA3B,EAAwC;AACtCL,MAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,QAAAA,MAAM,EAAE,GADW;AAEnBD,QAAAA,KAAK,EAAE;AAFY,OAArB;AAIA;AACD;;AACD,QAAMc,YAAY,GAAG;AACnBP,MAAAA,EAAE,EAAEM,WAAW,CAACN,EADG;AAEnBQ,MAAAA,KAAK,EAAEF,WAAW,CAACE,KAFA;AAGnBC,MAAAA,SAAS,EAAE,0BAASC,MAAT,CAAgB,IAAhB,CAHQ;AAInBC,MAAAA,YAAY,EAAEL,WAAW,CAACK,YAJP;AAKnBC,MAAAA,KAAK,EAAEN,WAAW,CAACM,KALA;AAMnBC,MAAAA,KAAK,EAAEP,WAAW,CAACO,KANA;AAOnBC,MAAAA,KAAK,EAAER,WAAW,CAACQ,KAPA;AAQnBpB,MAAAA,MAAM,EAAEN,GAAG,CAACI,IAAJ,CAASE;AARE,KAArB;AAUAQ,oBAAID,QAAJ,IAAgB;AACdD,MAAAA,EAAE,EAAEM,WAAW,CAACN,EADF;AAEde,MAAAA,KAAK,EAAET,WAAW,CAACS,KAFL;AAGdN,MAAAA,SAAS,EAAEF,YAAY,CAACE,SAHV;AAIdE,MAAAA,YAAY,EAAEL,WAAW,CAACK,YAJZ;AAKdC,MAAAA,KAAK,EAAEN,WAAW,CAACM,KALL;AAMdC,MAAAA,KAAK,EAAEP,WAAW,CAACO,KANL;AAOdC,MAAAA,KAAK,EAAER,WAAW,CAACQ,KAPL;AAQdpB,MAAAA,MAAM,EAAEa,YAAY,CAACb;AARP,KAAhB;AAUAL,IAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,MAAAA,MAAM,EAAE,GADW;AAEnBsB,MAAAA,IAAI,EAAET;AAFa,KAArB;AAIA;AACD;;AACDlB,EAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,IAAAA,MAAM,EAAE,GADW;AAEnBD,IAAAA,KAAK,EAAE;AAFY,GAArB;AAID,CAlDD;;eAoDeN,U","sourceRoot":"G:\\Auto-Mart-Website\\server\\controllers","sourcesContent":["import moment from 'moment';\r\nimport validateUpdateStatus from '../helpers/markCar';\r\nimport ads from '../models/ads';\r\n\r\nconst markadsold = (req, res) => {\r\n  const { error } = validateUpdateStatus.validation(req.body);\r\n  if (error) {\r\n    res.status(400).json({\r\n      status: 400,\r\n      error: error.details[0].message,\r\n    });\r\n    return;\r\n  }\r\n  const carId = req.params.id;\r\n  const carIndex = ads.findIndex(o => o.id === parseInt(carId, 10));\r\n  if (carIndex > -1) {\r\n    const originalCar = ads[carIndex];\r\n    if (originalCar.status !== 'available') {\r\n      res.status(400).json({\r\n        status: 400,\r\n        error: 'you can not change the status of this car',\r\n      });\r\n      return;\r\n    }\r\n    const newCarStatus = {\r\n      id: originalCar.id,\r\n      email: originalCar.email,\r\n      createdOn: moment().format('LL'),\r\n      manufacturer: originalCar.manufacturer,\r\n      model: originalCar.model,\r\n      price: originalCar.price,\r\n      state: originalCar.state,\r\n      status: req.body.status,\r\n    };\r\n    ads[carIndex] = {\r\n      id: originalCar.id,\r\n      owner: originalCar.owner,\r\n      createdOn: newCarStatus.createdOn,\r\n      manufacturer: originalCar.manufacturer,\r\n      model: originalCar.model,\r\n      price: originalCar.price,\r\n      state: originalCar.state,\r\n      status: newCarStatus.status,\r\n    };\r\n    res.status(200).json({\r\n      status: 200,\r\n      data: newCarStatus,\r\n    });\r\n    return;\r\n  }\r\n  res.status(404).json({\r\n    status: 404,\r\n    error: 'car post not found',\r\n  });\r\n};\r\n\r\nexport default markadsold;\r\n"]}