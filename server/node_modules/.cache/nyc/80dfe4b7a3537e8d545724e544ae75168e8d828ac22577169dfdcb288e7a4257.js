"use strict";var cov_5sevvbedf=function(){var path="C:\\Auto-Mart-Website\\server\\controllers\\purchaseOrder.js";var hash="1f35aff8a56f19c9ac9cb68fd6e1b7bd6e30c6c0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Auto-Mart-Website\\server\\controllers\\purchaseOrder.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:28}},"2":{start:{line:8,column:21},end:{line:8,column:79}},"3":{start:{line:10,column:13},end:{line:10,column:63}},"4":{start:{line:12,column:16},end:{line:12,column:69}},"5":{start:{line:14,column:22},end:{line:14,column:81}},"6":{start:{line:16,column:39},end:{line:16,column:95}},"7":{start:{line:18,column:12},end:{line:73,column:1}},"8":{start:{line:19,column:30},end:{line:19,column:77}},"9":{start:{line:20,column:14},end:{line:20,column:41}},"10":{start:{line:22,column:2},end:{line:27,column:3}},"11":{start:{line:23,column:4},end:{line:26,column:7}},"12":{start:{line:29,column:17},end:{line:35,column:3}},"13":{start:{line:37,column:15},end:{line:39,column:4}},"14":{start:{line:38,column:4},end:{line:38,column:49}},"15":{start:{line:41,column:2},end:{line:46,column:3}},"16":{start:{line:42,column:4},end:{line:45,column:7}},"17":{start:{line:48,column:14},end:{line:50,column:4}},"18":{start:{line:49,column:4},end:{line:49,column:50}},"19":{start:{line:52,column:2},end:{line:57,column:3}},"20":{start:{line:53,column:4},end:{line:56,column:7}},"21":{start:{line:59,column:20},end:{line:65,column:3}},"22":{start:{line:67,column:2},end:{line:67,column:43}},"23":{start:{line:69,column:2},end:{line:72,column:5}},"24":{start:{line:75,column:15},end:{line:75,column:20}},"25":{start:{line:76,column:0},end:{line:76,column:30}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:16,column:9},end:{line:16,column:31}},loc:{start:{line:16,column:37},end:{line:16,column:97}},line:16},"1":{name:"Order",decl:{start:{line:18,column:21},end:{line:18,column:26}},loc:{start:{line:18,column:37},end:{line:73,column:1}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:37,column:38},end:{line:37,column:39}},loc:{start:{line:37,column:51},end:{line:39,column:3}},line:37},"3":{name:"(anonymous_3)",decl:{start:{line:48,column:40},end:{line:48,column:41}},loc:{start:{line:48,column:53},end:{line:50,column:3}},line:48}},branchMap:{"0":{loc:{start:{line:16,column:46},end:{line:16,column:94}},type:"cond-expr",locations:[{start:{line:16,column:70},end:{line:16,column:73}},{start:{line:16,column:76},end:{line:16,column:94}}],line:16},"1":{loc:{start:{line:16,column:46},end:{line:16,column:67}},type:"binary-expr",locations:[{start:{line:16,column:46},end:{line:16,column:49}},{start:{line:16,column:53},end:{line:16,column:67}}],line:16},"2":{loc:{start:{line:22,column:2},end:{line:27,column:3}},type:"if",locations:[{start:{line:22,column:2},end:{line:27,column:3}},{start:{line:22,column:2},end:{line:27,column:3}}],line:22},"3":{loc:{start:{line:34,column:12},end:{line:34,column:40}},type:"binary-expr",locations:[{start:{line:34,column:12},end:{line:34,column:27}},{start:{line:34,column:31},end:{line:34,column:40}}],line:34},"4":{loc:{start:{line:41,column:2},end:{line:46,column:3}},type:"if",locations:[{start:{line:41,column:2},end:{line:46,column:3}},{start:{line:41,column:2},end:{line:46,column:3}}],line:41},"5":{loc:{start:{line:52,column:2},end:{line:57,column:3}},type:"if",locations:[{start:{line:52,column:2},end:{line:57,column:3}},{start:{line:52,column:2},end:{line:57,column:3}}],line:52}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"1f35aff8a56f19c9ac9cb68fd6e1b7bd6e30c6c0"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_5sevvbedf.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_5sevvbedf.s[1]++;exports["default"]=void 0;var _purchaseOrder=(cov_5sevvbedf.s[2]++,_interopRequireDefault(require("../models/purchaseOrder")));var _users=(cov_5sevvbedf.s[3]++,_interopRequireDefault(require("../models/users")));var _postCars=(cov_5sevvbedf.s[4]++,_interopRequireDefault(require("../models/postCars")));var _purchaseOrder2=(cov_5sevvbedf.s[5]++,_interopRequireDefault(require("../helpers/purchaseOrder")));function _interopRequireDefault(obj){cov_5sevvbedf.f[0]++;cov_5sevvbedf.s[6]++;return(cov_5sevvbedf.b[1][0]++,obj)&&(cov_5sevvbedf.b[1][1]++,obj.__esModule)?(cov_5sevvbedf.b[0][0]++,obj):(cov_5sevvbedf.b[0][1]++,{"default":obj});}cov_5sevvbedf.s[7]++;var Order=function Order(req,res){cov_5sevvbedf.f[1]++;var _validateOrder$valida=(cov_5sevvbedf.s[8]++,_purchaseOrder2["default"].validation(req.body)),error=(cov_5sevvbedf.s[9]++,_validateOrder$valida.error);cov_5sevvbedf.s[10]++;if(error){cov_5sevvbedf.b[2][0]++;cov_5sevvbedf.s[11]++;return res.status(400).json({status:400,error:error.details[0].message});}else{cov_5sevvbedf.b[2][1]++;}var newOrder=(cov_5sevvbedf.s[12]++,{id:parseInt(_purchaseOrder["default"].length+1,10),buyer:req.body.buyer,car_id:req.body.car_id,amount:req.body.amount,status:(cov_5sevvbedf.b[3][0]++,req.body.status)||(cov_5sevvbedf.b[3][1]++,'pending')});var userId=(cov_5sevvbedf.s[13]++,_users["default"].find(function(b){cov_5sevvbedf.f[2]++;cov_5sevvbedf.s[14]++;return b.id===parseInt(newOrder.buyer,10);}));cov_5sevvbedf.s[15]++;if(!userId){cov_5sevvbedf.b[4][0]++;cov_5sevvbedf.s[16]++;return res.status(404).json({status:404,error:'buyer id not found'});}else{cov_5sevvbedf.b[4][1]++;}var carId=(cov_5sevvbedf.s[17]++,_postCars["default"].find(function(c){cov_5sevvbedf.f[3]++;cov_5sevvbedf.s[18]++;return c.id===parseInt(newOrder.car_id,10);}));cov_5sevvbedf.s[19]++;if(!carId){cov_5sevvbedf.b[5][0]++;cov_5sevvbedf.s[20]++;return res.status(404).json({status:404,error:'car ordered not found'});}else{cov_5sevvbedf.b[5][1]++;}var latestOrder=(cov_5sevvbedf.s[21]++,{car_id:newOrder.car_id,created_on:Date(),status:newOrder.status,price:carId.price,price_offered:newOrder.amount});cov_5sevvbedf.s[22]++;_purchaseOrder["default"].push(newOrder);cov_5sevvbedf.s[23]++;return res.status(201).json({status:201,data:latestOrder});};var _default=(cov_5sevvbedf.s[24]++,Order);cov_5sevvbedf.s[25]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1cmNoYXNlT3JkZXIuanMiXSwibmFtZXMiOlsiT3JkZXIiLCJyZXEiLCJyZXMiLCJ2YWxpZGF0ZU9yZGVyIiwidmFsaWRhdGlvbiIsImJvZHkiLCJlcnJvciIsInN0YXR1cyIsImpzb24iLCJkZXRhaWxzIiwibWVzc2FnZSIsIm5ld09yZGVyIiwiaWQiLCJwYXJzZUludCIsIm9yZGVyIiwibGVuZ3RoIiwiYnV5ZXIiLCJjYXJfaWQiLCJhbW91bnQiLCJ1c2VySWQiLCJ1c2VycyIsImZpbmQiLCJiIiwiY2FySWQiLCJjYXJzIiwiYyIsImxhdGVzdE9yZGVyIiwiY3JlYXRlZF9vbiIsIkRhdGUiLCJwcmljZSIsInByaWNlX29mZmVyZWQiLCJwdXNoIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBTUEsS0FBSyxHQUFHLFNBQVJBLEtBQVEsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFBQSw4QkFDUkMsMkJBQWNDLFVBQWQsQ0FBeUJILEdBQUcsQ0FBQ0ksSUFBN0IsQ0FEUTtBQUFBLE1BQ2xCQyxLQURrQix5QkFDbEJBLEtBRGtCOztBQUUxQixNQUFJQSxLQUFKLEVBQVc7QUFDVCxXQUFPSixHQUFHLENBQUNLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUFFRCxNQUFBQSxNQUFNLEVBQUUsR0FBVjtBQUFlRCxNQUFBQSxLQUFLLEVBQUVBLEtBQUssQ0FBQ0csT0FBTixDQUFjLENBQWQsRUFBaUJDO0FBQXZDLEtBQXJCLENBQVA7QUFDRDs7QUFFRCxNQUFNQyxRQUFRLEdBQUc7QUFDZkMsSUFBQUEsRUFBRSxFQUFFQyxRQUFRLENBQUNDLDBCQUFNQyxNQUFOLEdBQWUsQ0FBaEIsRUFBbUIsRUFBbkIsQ0FERztBQUVmQyxJQUFBQSxLQUFLLEVBQUVmLEdBQUcsQ0FBQ0ksSUFBSixDQUFTVyxLQUZEO0FBR2ZDLElBQUFBLE1BQU0sRUFBRWhCLEdBQUcsQ0FBQ0ksSUFBSixDQUFTWSxNQUhGO0FBSWZDLElBQUFBLE1BQU0sRUFBRWpCLEdBQUcsQ0FBQ0ksSUFBSixDQUFTYSxNQUpGO0FBS2ZYLElBQUFBLE1BQU0sRUFBRU4sR0FBRyxDQUFDSSxJQUFKLENBQVNFLE1BQVQsSUFBbUI7QUFMWixHQUFqQjs7QUFPQSxNQUFNWSxNQUFNLEdBQUdDLGtCQUFNQyxJQUFOLENBQVcsVUFBQUMsQ0FBQztBQUFBLFdBQUlBLENBQUMsQ0FBQ1YsRUFBRixLQUFTQyxRQUFRLENBQUNGLFFBQVEsQ0FBQ0ssS0FBVixFQUFpQixFQUFqQixDQUFyQjtBQUFBLEdBQVosQ0FBZjs7QUFDQSxNQUFJLENBQUNHLE1BQUwsRUFBYTtBQUNYLFdBQU9qQixHQUFHLENBQUNLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsTUFBQUEsTUFBTSxFQUFFLEdBRGtCO0FBRTFCRCxNQUFBQSxLQUFLLEVBQUU7QUFGbUIsS0FBckIsQ0FBUDtBQUlEOztBQUVELE1BQU1pQixLQUFLLEdBQUdDLHFCQUFLSCxJQUFMLENBQVUsVUFBQUksQ0FBQztBQUFBLFdBQUlBLENBQUMsQ0FBQ2IsRUFBRixLQUFTQyxRQUFRLENBQUNGLFFBQVEsQ0FBQ00sTUFBVixFQUFrQixFQUFsQixDQUFyQjtBQUFBLEdBQVgsQ0FBZDs7QUFDQSxNQUFJLENBQUNNLEtBQUwsRUFBWTtBQUNWLFdBQU9yQixHQUFHLENBQUNLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsTUFBQUEsTUFBTSxFQUFFLEdBRGtCO0FBRTFCRCxNQUFBQSxLQUFLLEVBQUU7QUFGbUIsS0FBckIsQ0FBUDtBQUlEOztBQUNBLE1BQU1vQixXQUFXLEdBQUc7QUFDakJULElBQUFBLE1BQU0sRUFBRU4sUUFBUSxDQUFDTSxNQURBO0FBRWpCVSxJQUFBQSxVQUFVLEVBQUVDLElBQUksRUFGQztBQUdqQnJCLElBQUFBLE1BQU0sRUFBRUksUUFBUSxDQUFDSixNQUhBO0FBSWpCc0IsSUFBQUEsS0FBSyxFQUFFTixLQUFLLENBQUNNLEtBSkk7QUFLakJDLElBQUFBLGFBQWEsRUFBRW5CLFFBQVEsQ0FBQ087QUFMUCxHQUFwQjs7QUFRREosNEJBQU1pQixJQUFOLENBQVdwQixRQUFYOztBQUNBLFNBQU9ULEdBQUcsQ0FBQ0ssTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQzFCRCxJQUFBQSxNQUFNLEVBQUUsR0FEa0I7QUFFMUJ5QixJQUFBQSxJQUFJLEVBQUVOO0FBRm9CLEdBQXJCLENBQVA7QUFJRCxDQXpDRDs7ZUEyQ2UxQixLIiwic291cmNlUm9vdCI6IkM6XFxBdXRvLU1hcnQtV2Vic2l0ZVxcc2VydmVyXFxjb250cm9sbGVycyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBvcmRlciBmcm9tICcuLi9tb2RlbHMvcHVyY2hhc2VPcmRlcic7XHJcbmltcG9ydCB1c2VycyBmcm9tICcuLi9tb2RlbHMvdXNlcnMnO1xyXG5pbXBvcnQgY2FycyBmcm9tICcuLi9tb2RlbHMvcG9zdENhcnMnO1xyXG5pbXBvcnQgdmFsaWRhdGVPcmRlciBmcm9tICcuLi9oZWxwZXJzL3B1cmNoYXNlT3JkZXInO1xyXG5cclxuY29uc3QgT3JkZXIgPSAocmVxLCByZXMpID0+IHtcclxuICBjb25zdCB7IGVycm9yIH0gPSB2YWxpZGF0ZU9yZGVyLnZhbGlkYXRpb24ocmVxLmJvZHkpO1xyXG4gIGlmIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3RhdHVzOiA0MDAsIGVycm9yOiBlcnJvci5kZXRhaWxzWzBdLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBuZXdPcmRlciA9IHtcclxuICAgIGlkOiBwYXJzZUludChvcmRlci5sZW5ndGggKyAxLCAxMCksXHJcbiAgICBidXllcjogcmVxLmJvZHkuYnV5ZXIsXHJcbiAgICBjYXJfaWQ6IHJlcS5ib2R5LmNhcl9pZCxcclxuICAgIGFtb3VudDogcmVxLmJvZHkuYW1vdW50LFxyXG4gICAgc3RhdHVzOiByZXEuYm9keS5zdGF0dXMgfHwgJ3BlbmRpbmcnLFxyXG4gIH07XHJcbiAgY29uc3QgdXNlcklkID0gdXNlcnMuZmluZChiID0+IGIuaWQgPT09IHBhcnNlSW50KG5ld09yZGVyLmJ1eWVyLCAxMCkpO1xyXG4gIGlmICghdXNlcklkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgZXJyb3I6ICdidXllciBpZCBub3QgZm91bmQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjYXJJZCA9IGNhcnMuZmluZChjID0+IGMuaWQgPT09IHBhcnNlSW50KG5ld09yZGVyLmNhcl9pZCwgMTApKTtcclxuICBpZiAoIWNhcklkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgZXJyb3I6ICdjYXIgb3JkZXJlZCBub3QgZm91bmQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gICBjb25zdCBsYXRlc3RPcmRlciA9IHtcclxuICAgICAgY2FyX2lkOiBuZXdPcmRlci5jYXJfaWQsXHJcbiAgICAgIGNyZWF0ZWRfb246IERhdGUoKSxcclxuICAgICAgc3RhdHVzOiBuZXdPcmRlci5zdGF0dXMsXHJcbiAgICAgIHByaWNlOiBjYXJJZC5wcmljZSxcclxuICAgICAgcHJpY2Vfb2ZmZXJlZDogbmV3T3JkZXIuYW1vdW50XHJcbiAgfTtcclxuXHJcbiAgb3JkZXIucHVzaChuZXdPcmRlcik7XHJcbiAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgIHN0YXR1czogMjAxLFxyXG4gICAgZGF0YTogbGF0ZXN0T3JkZXJcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE9yZGVyO1xyXG4iXX0=