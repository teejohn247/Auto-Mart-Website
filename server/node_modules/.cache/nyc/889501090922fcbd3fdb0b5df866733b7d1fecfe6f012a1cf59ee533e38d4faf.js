"use strict";var cov_5sevvbedf=function(){var path="C:\\Auto-Mart-Website\\server\\controllers\\purchaseOrder.js";var hash="e0bd91d0878e20771dc7937113c906e9c8a6d913";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Auto-Mart-Website\\server\\controllers\\purchaseOrder.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:28}},"2":{start:{line:8,column:14},end:{line:8,column:55}},"3":{start:{line:10,column:21},end:{line:10,column:79}},"4":{start:{line:12,column:13},end:{line:12,column:63}},"5":{start:{line:14,column:16},end:{line:14,column:69}},"6":{start:{line:16,column:22},end:{line:16,column:81}},"7":{start:{line:18,column:39},end:{line:18,column:95}},"8":{start:{line:20,column:12},end:{line:75,column:1}},"9":{start:{line:21,column:30},end:{line:21,column:77}},"10":{start:{line:22,column:14},end:{line:22,column:41}},"11":{start:{line:24,column:2},end:{line:29,column:3}},"12":{start:{line:25,column:4},end:{line:28,column:7}},"13":{start:{line:31,column:11},end:{line:31,column:61}},"14":{start:{line:32,column:17},end:{line:38,column:3}},"15":{start:{line:40,column:15},end:{line:42,column:4}},"16":{start:{line:41,column:4},end:{line:41,column:49}},"17":{start:{line:44,column:2},end:{line:49,column:3}},"18":{start:{line:45,column:4},end:{line:48,column:7}},"19":{start:{line:51,column:14},end:{line:53,column:4}},"20":{start:{line:52,column:4},end:{line:52,column:50}},"21":{start:{line:55,column:2},end:{line:60,column:3}},"22":{start:{line:56,column:4},end:{line:59,column:7}},"23":{start:{line:62,column:2},end:{line:62,column:43}},"24":{start:{line:64,column:2},end:{line:74,column:5}},"25":{start:{line:77,column:15},end:{line:77,column:20}},"26":{start:{line:78,column:0},end:{line:78,column:30}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:18,column:9},end:{line:18,column:31}},loc:{start:{line:18,column:37},end:{line:18,column:97}},line:18},"1":{name:"Order",decl:{start:{line:20,column:21},end:{line:20,column:26}},loc:{start:{line:20,column:37},end:{line:75,column:1}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:40,column:38},end:{line:40,column:39}},loc:{start:{line:40,column:51},end:{line:42,column:3}},line:40},"3":{name:"(anonymous_3)",decl:{start:{line:51,column:40},end:{line:51,column:41}},loc:{start:{line:51,column:53},end:{line:53,column:3}},line:51}},branchMap:{"0":{loc:{start:{line:18,column:46},end:{line:18,column:94}},type:"cond-expr",locations:[{start:{line:18,column:70},end:{line:18,column:73}},{start:{line:18,column:76},end:{line:18,column:94}}],line:18},"1":{loc:{start:{line:18,column:46},end:{line:18,column:67}},type:"binary-expr",locations:[{start:{line:18,column:46},end:{line:18,column:49}},{start:{line:18,column:53},end:{line:18,column:67}}],line:18},"2":{loc:{start:{line:24,column:2},end:{line:29,column:3}},type:"if",locations:[{start:{line:24,column:2},end:{line:29,column:3}},{start:{line:24,column:2},end:{line:29,column:3}}],line:24},"3":{loc:{start:{line:37,column:12},end:{line:37,column:40}},type:"binary-expr",locations:[{start:{line:37,column:12},end:{line:37,column:27}},{start:{line:37,column:31},end:{line:37,column:40}}],line:37},"4":{loc:{start:{line:44,column:2},end:{line:49,column:3}},type:"if",locations:[{start:{line:44,column:2},end:{line:49,column:3}},{start:{line:44,column:2},end:{line:49,column:3}}],line:44},"5":{loc:{start:{line:55,column:2},end:{line:60,column:3}},type:"if",locations:[{start:{line:55,column:2},end:{line:60,column:3}},{start:{line:55,column:2},end:{line:60,column:3}}],line:55}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"e0bd91d0878e20771dc7937113c906e9c8a6d913"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_5sevvbedf.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_5sevvbedf.s[1]++;exports["default"]=void 0;var _moment=(cov_5sevvbedf.s[2]++,_interopRequireDefault(require("moment")));var _purchaseOrder=(cov_5sevvbedf.s[3]++,_interopRequireDefault(require("../models/purchaseOrder")));var _users=(cov_5sevvbedf.s[4]++,_interopRequireDefault(require("../models/users")));var _postCars=(cov_5sevvbedf.s[5]++,_interopRequireDefault(require("../models/postCars")));var _purchaseOrder2=(cov_5sevvbedf.s[6]++,_interopRequireDefault(require("../helpers/purchaseOrder")));function _interopRequireDefault(obj){cov_5sevvbedf.f[0]++;cov_5sevvbedf.s[7]++;return(cov_5sevvbedf.b[1][0]++,obj)&&(cov_5sevvbedf.b[1][1]++,obj.__esModule)?(cov_5sevvbedf.b[0][0]++,obj):(cov_5sevvbedf.b[0][1]++,{"default":obj});}cov_5sevvbedf.s[8]++;var Order=function Order(req,res){cov_5sevvbedf.f[1]++;var _validateOrder$valida=(cov_5sevvbedf.s[9]++,_purchaseOrder2["default"].validation(req.body)),error=(cov_5sevvbedf.s[10]++,_validateOrder$valida.error);cov_5sevvbedf.s[11]++;if(error){cov_5sevvbedf.b[2][0]++;cov_5sevvbedf.s[12]++;return res.status(400).json({status:400,error:error.details[0].message});}else{cov_5sevvbedf.b[2][1]++;}var id=(cov_5sevvbedf.s[13]++,parseInt(_purchaseOrder["default"].length+1,10));var newOrder=(cov_5sevvbedf.s[14]++,{id:id,buyer:req.body.buyer,car_id:req.body.car_id,amount:req.body.amount,status:(cov_5sevvbedf.b[3][0]++,req.body.status)||(cov_5sevvbedf.b[3][1]++,'pending')});var userId=(cov_5sevvbedf.s[15]++,_users["default"].find(function(b){cov_5sevvbedf.f[2]++;cov_5sevvbedf.s[16]++;return b.id===parseInt(newOrder.buyer,10);}));cov_5sevvbedf.s[17]++;if(!userId){cov_5sevvbedf.b[4][0]++;cov_5sevvbedf.s[18]++;return res.status(404).json({status:404,error:'buyer id not found'});}else{cov_5sevvbedf.b[4][1]++;}var carId=(cov_5sevvbedf.s[19]++,_postCars["default"].find(function(c){cov_5sevvbedf.f[3]++;cov_5sevvbedf.s[20]++;return c.id===parseInt(newOrder.car_id,10);}));cov_5sevvbedf.s[21]++;if(!carId){cov_5sevvbedf.b[5][0]++;cov_5sevvbedf.s[22]++;return res.status(404).json({status:404,error:'car ordered not found'});}else{cov_5sevvbedf.b[5][1]++;}cov_5sevvbedf.s[23]++;_purchaseOrder["default"].push(newOrder);cov_5sevvbedf.s[24]++;return res.status(201).json({status:201,data:{id:id,car_id:newOrder.car_id,created_on:(0,_moment["default"])().format('LL'),status:newOrder.status,price:carId.price,price_offered:newOrder.amount}});};var _default=(cov_5sevvbedf.s[25]++,Order);cov_5sevvbedf.s[26]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1cmNoYXNlT3JkZXIuanMiXSwibmFtZXMiOlsiT3JkZXIiLCJyZXEiLCJyZXMiLCJ2YWxpZGF0ZU9yZGVyIiwidmFsaWRhdGlvbiIsImJvZHkiLCJlcnJvciIsInN0YXR1cyIsImpzb24iLCJkZXRhaWxzIiwibWVzc2FnZSIsImlkIiwicGFyc2VJbnQiLCJvcmRlciIsImxlbmd0aCIsIm5ld09yZGVyIiwiYnV5ZXIiLCJjYXJfaWQiLCJhbW91bnQiLCJ1c2VySWQiLCJ1c2VycyIsImZpbmQiLCJiIiwiY2FySWQiLCJjYXJzIiwiYyIsInB1c2giLCJkYXRhIiwiY3JlYXRlZF9vbiIsImZvcm1hdCIsInByaWNlIiwicHJpY2Vfb2ZmZXJlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBTUEsS0FBSyxHQUFHLFNBQVJBLEtBQVEsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFBQSw4QkFDUkMsMkJBQWNDLFVBQWQsQ0FBeUJILEdBQUcsQ0FBQ0ksSUFBN0IsQ0FEUTtBQUFBLE1BQ2xCQyxLQURrQix5QkFDbEJBLEtBRGtCOztBQUUxQixNQUFJQSxLQUFKLEVBQVc7QUFDVCxXQUFPSixHQUFHLENBQUNLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUFFRCxNQUFBQSxNQUFNLEVBQUUsR0FBVjtBQUFlRCxNQUFBQSxLQUFLLEVBQUVBLEtBQUssQ0FBQ0csT0FBTixDQUFjLENBQWQsRUFBaUJDO0FBQXZDLEtBQXJCLENBQVA7QUFDRDs7QUFFRCxNQUFNQyxFQUFFLEdBQUdDLFFBQVEsQ0FBQ0MsMEJBQU1DLE1BQU4sR0FBZSxDQUFoQixFQUFtQixFQUFuQixDQUFuQjtBQUNBLE1BQU1DLFFBQVEsR0FBRztBQUNmSixJQUFBQSxFQUFFLEVBQUZBLEVBRGU7QUFFZkssSUFBQUEsS0FBSyxFQUFFZixHQUFHLENBQUNJLElBQUosQ0FBU1csS0FGRDtBQUdmQyxJQUFBQSxNQUFNLEVBQUVoQixHQUFHLENBQUNJLElBQUosQ0FBU1ksTUFIRjtBQUlmQyxJQUFBQSxNQUFNLEVBQUVqQixHQUFHLENBQUNJLElBQUosQ0FBU2EsTUFKRjtBQUtmWCxJQUFBQSxNQUFNLEVBQUVOLEdBQUcsQ0FBQ0ksSUFBSixDQUFTRSxNQUFULElBQW1CO0FBTFosR0FBakI7O0FBT0EsTUFBTVksTUFBTSxHQUFHQyxrQkFBTUMsSUFBTixDQUFXLFVBQUFDLENBQUM7QUFBQSxXQUFJQSxDQUFDLENBQUNYLEVBQUYsS0FBU0MsUUFBUSxDQUFDRyxRQUFRLENBQUNDLEtBQVYsRUFBaUIsRUFBakIsQ0FBckI7QUFBQSxHQUFaLENBQWY7O0FBQ0EsTUFBSSxDQUFDRyxNQUFMLEVBQWE7QUFDWCxXQUFPakIsR0FBRyxDQUFDSyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJELE1BQUFBLE1BQU0sRUFBRSxHQURrQjtBQUUxQkQsTUFBQUEsS0FBSyxFQUFFO0FBRm1CLEtBQXJCLENBQVA7QUFJRDs7QUFFRCxNQUFNaUIsS0FBSyxHQUFHQyxxQkFBS0gsSUFBTCxDQUFVLFVBQUFJLENBQUM7QUFBQSxXQUFJQSxDQUFDLENBQUNkLEVBQUYsS0FBU0MsUUFBUSxDQUFDRyxRQUFRLENBQUNFLE1BQVYsRUFBa0IsRUFBbEIsQ0FBckI7QUFBQSxHQUFYLENBQWQ7O0FBQ0EsTUFBSSxDQUFDTSxLQUFMLEVBQVk7QUFDVixXQUFPckIsR0FBRyxDQUFDSyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDMUJELE1BQUFBLE1BQU0sRUFBRSxHQURrQjtBQUUxQkQsTUFBQUEsS0FBSyxFQUFFO0FBRm1CLEtBQXJCLENBQVA7QUFJRDs7QUFFRE8sNEJBQU1hLElBQU4sQ0FBV1gsUUFBWDs7QUFDQSxTQUFPYixHQUFHLENBQUNLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQjtBQUMxQkQsSUFBQUEsTUFBTSxFQUFFLEdBRGtCO0FBRTFCb0IsSUFBQUEsSUFBSSxFQUFFO0FBQ0poQixNQUFBQSxFQUFFLEVBQUZBLEVBREk7QUFFSk0sTUFBQUEsTUFBTSxFQUFFRixRQUFRLENBQUNFLE1BRmI7QUFHSlcsTUFBQUEsVUFBVSxFQUFFLDBCQUFTQyxNQUFULENBQWdCLElBQWhCLENBSFI7QUFJSnRCLE1BQUFBLE1BQU0sRUFBRVEsUUFBUSxDQUFDUixNQUpiO0FBS0p1QixNQUFBQSxLQUFLLEVBQUVQLEtBQUssQ0FBQ08sS0FMVDtBQU1KQyxNQUFBQSxhQUFhLEVBQUVoQixRQUFRLENBQUNHO0FBTnBCO0FBRm9CLEdBQXJCLENBQVA7QUFXRCxDQTFDRDs7ZUE0Q2VsQixLIiwic291cmNlUm9vdCI6IkM6XFxBdXRvLU1hcnQtV2Vic2l0ZVxcc2VydmVyXFxjb250cm9sbGVycyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IG9yZGVyIGZyb20gJy4uL21vZGVscy9wdXJjaGFzZU9yZGVyJztcclxuaW1wb3J0IHVzZXJzIGZyb20gJy4uL21vZGVscy91c2Vycyc7XHJcbmltcG9ydCBjYXJzIGZyb20gJy4uL21vZGVscy9wb3N0Q2Fycyc7XHJcbmltcG9ydCB2YWxpZGF0ZU9yZGVyIGZyb20gJy4uL2hlbHBlcnMvcHVyY2hhc2VPcmRlcic7XHJcblxyXG5jb25zdCBPcmRlciA9IChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgZXJyb3IgfSA9IHZhbGlkYXRlT3JkZXIudmFsaWRhdGlvbihyZXEuYm9keSk7XHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdGF0dXM6IDQwMCwgZXJyb3I6IGVycm9yLmRldGFpbHNbMF0ubWVzc2FnZSB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGlkID0gcGFyc2VJbnQob3JkZXIubGVuZ3RoICsgMSwgMTApO1xyXG4gIGNvbnN0IG5ld09yZGVyID0ge1xyXG4gICAgaWQsXHJcbiAgICBidXllcjogcmVxLmJvZHkuYnV5ZXIsXHJcbiAgICBjYXJfaWQ6IHJlcS5ib2R5LmNhcl9pZCxcclxuICAgIGFtb3VudDogcmVxLmJvZHkuYW1vdW50LFxyXG4gICAgc3RhdHVzOiByZXEuYm9keS5zdGF0dXMgfHwgJ3BlbmRpbmcnLFxyXG4gIH07XHJcbiAgY29uc3QgdXNlcklkID0gdXNlcnMuZmluZChiID0+IGIuaWQgPT09IHBhcnNlSW50KG5ld09yZGVyLmJ1eWVyLCAxMCkpO1xyXG4gIGlmICghdXNlcklkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgZXJyb3I6ICdidXllciBpZCBub3QgZm91bmQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjYXJJZCA9IGNhcnMuZmluZChjID0+IGMuaWQgPT09IHBhcnNlSW50KG5ld09yZGVyLmNhcl9pZCwgMTApKTtcclxuICBpZiAoIWNhcklkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgZXJyb3I6ICdjYXIgb3JkZXJlZCBub3QgZm91bmQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvcmRlci5wdXNoKG5ld09yZGVyKTtcclxuICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xyXG4gICAgc3RhdHVzOiAyMDEsXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIGlkLFxyXG4gICAgICBjYXJfaWQ6IG5ld09yZGVyLmNhcl9pZCxcclxuICAgICAgY3JlYXRlZF9vbjogbW9tZW50KCkuZm9ybWF0KCdMTCcpLFxyXG4gICAgICBzdGF0dXM6IG5ld09yZGVyLnN0YXR1cyxcclxuICAgICAgcHJpY2U6IGNhcklkLnByaWNlLFxyXG4gICAgICBwcmljZV9vZmZlcmVkOiBuZXdPcmRlci5hbW91bnQsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgT3JkZXI7XHJcbiJdfQ==